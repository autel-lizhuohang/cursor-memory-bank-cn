---
description: ä¼˜åŒ–çš„ä¸»è§„åˆ™ï¼Œç”¨äºæé«˜ Token æ•ˆç‡
globs: main.mdc
alwaysApply: false
---
# ğŸ” ä¼˜åŒ–çš„memory bankç³»ç»Ÿ

## Memory Bank æœºåˆ¶

**æˆ‘çš„è®°å¿†åœ¨æ¯æ¬¡ä¼šè¯åå®Œå…¨é‡ç½®ã€‚Memory Bank æ˜¯æˆ‘ç†è§£é¡¹ç›®çš„å”¯ä¸€é€”å¾„ã€‚**

ğŸš¨ å…³é”®è§„åˆ™ï¼šmemory bankåˆ›å»ºæ˜¯å¼ºåˆ¶æ€§çš„ ğŸš¨
åœ¨ä»»ä½•æ¨¡å¼ä¸‹ï¼Œmemory bankå¿…é¡»åœ¨ä»»ä½•å…¶ä»–æ“ä½œä¹‹å‰åˆ›å»º
æ²¡æœ‰éªŒè¯memory bankå­˜åœ¨ï¼Œä»»ä½•æµç¨‹éƒ½ä¸èƒ½ç»§ç»­

> **ç®€è¦è¯´æ˜ï¼š** æœ¬ç³»ç»Ÿä½¿ç”¨ä¼˜åŒ–çš„ä¸Šä¸‹æ–‡ç®¡ç†å’Œè‡ªé€‚åº”è§„åˆ™åŠ è½½ï¼Œä»¥æœ€å¤§åŒ– Token æ•ˆç‡ï¼ŒåŒæ—¶ä¿ç•™ç»“æ„åŒ–å¼€å‘æ–¹æ³•ã€‚

## ğŸ§­ ä¼˜åŒ–çš„æ¨¡å¼æ¶æ„

```mermaid
graph TD
    subgraph "Memory Bank Core"
        Context["Context Manager"]
        Rules["Rule Loader"]
        FileIO["File Manager"]
        Transition["Mode Transition"]
    end

    subgraph "Custom Modes"
        VAN["VAN<br>Initialization"]
        PLAN["PLAN<br>Planning"]
        CREATIVE["CREATIVE<br>Design"]
        BUILD["BUILD<br>Building"]
        REFLECT["REFLECT<br>Review"]
        ARCHIVE["ARCHIVE<br>Documentation"]
    end

    Context --> VAN & PLAN & CREATIVE & BUILD & REFLECT & ARCHIVE
    Rules --> VAN & PLAN & CREATIVE & BUILD & REFLECT & ARCHIVE
    FileIO --> VAN & PLAN & CREATIVE & BUILD & REFLECT & ARCHIVE
    Transition --> VAN & PLAN & CREATIVE & BUILD & REFLECT & ARCHIVE

    VAN --> PLAN
    PLAN --> CREATIVE
    CREATIVE --> BUILD
    BUILD --> REFLECT
    REFLECT --> ARCHIVE

    style Context fill:#4da6ff,stroke:#0066cc,color:white
    style Rules fill:#ffa64d,stroke:#cc7a30,color:white
    style FileIO fill:#4dbb5f,stroke:#36873f,color:white
    style Transition fill:#d94dbb,stroke:#a3378a,color:white
```

## ğŸ“ˆ è‡ªé€‚åº”å¤æ‚åº¦æ¨¡å‹

```mermaid
graph TD
    Task["Task Creation"] --> Complexity{"Complexity<br>Level?"}

    Complexity -->|"Level 1<br>Quick Fix"| L1["3-Phase<br>Streamlined Process"]
    Complexity -->|"Level 2<br>Enhancement"| L2["4-Phase<br>Balanced Process"]
    Complexity -->|"Level 3<br>Feature"| L3["5-Phase<br>Comprehensive Process"]
    Complexity -->|"Level 4<br>Enterprise"| L4["6-Phase<br>Governance Process"]

    L1 --> L1_Process["VAN â†’ BUILD â†’ REFLECT"]
    L2 --> L2_Process["VAN â†’ PLAN â†’ BUILD â†’ REFLECT"]
    L3 --> L3_Process["VAN â†’ PLAN â†’ CREATIVE â†’ BUILD â†’ REFLECT"]
    L4 --> L4_Process["VAN â†’ PLAN â†’ CREATIVE â†’ BUILD â†’ REFLECT â†’ ARCHIVE"]

    style Complexity fill:#d94dbb,stroke:#a3378a,color:white
    style L1 fill:#4dbb5f,stroke:#36873f,color:white
    style L2 fill:#ffa64d,stroke:#cc7a30,color:white
    style L3 fill:#4da6ff,stroke:#0066cc,color:white
    style L4 fill:#ff5555,stroke:#cc0000,color:white
```

## ğŸ§  åˆ†å±‚è§„åˆ™åŠ è½½

è§„åˆ™æŒ‰å±‚æ¬¡åŠ è½½ä»¥ä¼˜åŒ–ä¸Šä¸‹æ–‡ä½¿ç”¨ï¼š

```mermaid
graph TD
    Root["Memory Bank<br>Common Rules"] --> Core["Core Rules<br>Shared Across Modes"]

    Core --> L1["Level 1<br>Rules"]
    Core --> L2["Level 2<br>Rules"]
    Core --> L3["Level 3<br>Rules"]
    Core --> L4["Level 4<br>Rules"]

    Core --> VM["Mode<br>Visual Maps"]

    Core --> Phase["Phase-Specific<br>Rules"]

    Phase --> VAN_Rules["VAN Mode<br>Rules"]
    Phase --> PLAN_Rules["PLAN Mode<br>Rules"]
    Phase --> CREATIVE_Rules["CREATIVE Mode<br>Rules"]
    Phase --> BUILD_Rules["BUILD Mode<br>Rules"]
    Phase --> REFLECT_Rules["REFLECT Mode<br>Rules"]
    Phase --> ARCHIVE_Rules["ARCHIVE Mode<br>Rules"]

    style Root fill:#4da6ff,stroke:#0066cc,color:white
    style Core fill:#ffa64d,stroke:#cc7a30,color:white
    style Phase fill:#4dbb5f,stroke:#36873f,color:white
```

## ğŸ”„ Token ä¼˜åŒ–çš„åˆ›æ„é˜¶æ®µ

åˆ›æ„é˜¶æ®µæ–‡æ¡£é‡‡ç”¨æ¸è¿›å¼ç”Ÿæˆï¼š

```mermaid
graph TD
    Start["Creative Phase<br>Initiation"] --> P1["1ï¸âƒ£ PROBLEM<br>Define scope"]
    P1 --> P2["2ï¸âƒ£ OPTIONS<br>List alternatives"]
    P2 --> P3["3ï¸âƒ£ ANALYSIS<br>Compare options"]
    P3 --> P4["4ï¸âƒ£ DECISION<br>Select approach"]
    P4 --> P5["5ï¸âƒ£ GUIDELINES<br>Document implementation"]

    P3 -.->|"On Demand"| Details["Detailed Option<br>Analysis"]

    style Start fill:#d971ff,stroke:#a33bc2,color:white
    style P1 fill:#4da6ff,stroke:#0066cc,color:white
    style P2 fill:#ffa64d,stroke:#cc7a30,color:white
    style P3 fill:#4dbb5f,stroke:#36873f,color:white
    style P4 fill:#d94dbb,stroke:#a3378a,color:white
    style P5 fill:#4dbbbb,stroke:#368787,color:white
    style Details fill:#e699d9,stroke:#d94dbb,color:white,stroke-dasharray: 5 5
```

## ğŸ”€ ä¼˜åŒ–çš„æ¨¡å¼è½¬æ¢

æ¨¡å¼è½¬æ¢ä½¿ç”¨ç»Ÿä¸€çš„ä¸Šä¸‹æ–‡ä¼ é€’åè®®ï¼š

```mermaid
sequenceDiagram
    participant Current as Current Mode
    participant Context as Context Manager
    participant Next as Next Mode

    Current->>Context: Create transition document
    Current->>Context: Store critical context
    Context->>Context: Prepare rule cache
    Current->>Next: Initiate transition
    Next->>Context: Verify context availability
    Context->>Next: Load relevant context
    Context->>Next: Load cached rules
    Next->>Next: Continue with preserved context
```

## ğŸ“Š memory banké«˜æ•ˆæ›´æ–°

```mermaid
graph TD
    subgraph "Memory Bank Files"
        tasks["tasks.md<br>Source of Truth"]
        active["activeContext.md<br>Current Focus"]
        creative["creative-*.md<br>Design Decisions"]
        progress["progress.md<br>Implementation Status"]
        transition["transition.md<br>Mode Transitions"]
    end

    Update["Update Request"] --> Diff{"Changed?"}
    Diff -->|"No"| Skip["Skip Update"]
    Diff -->|"Yes"| Section{"Section<br>Change?"}
    Section -->|"Yes"| Partial["Update Changed<br>Sections Only"]
    Section -->|"No"| Full["Full File<br>Update"]

    Partial --> tasks
    Full --> tasks

    style Update fill:#4da6ff,stroke:#0066cc,color:white
    style Diff fill:#ffa64d,stroke:#cc7a30,color:white
    style Section fill:#4dbb5f,stroke:#36873f,color:white
    style Partial fill:#d94dbb,stroke:#a3378a,color:white
    style Full fill:#4dbbbb,stroke:#368787,color:white
```

## ğŸ’» åŸºäºå¤æ‚åº¦çš„æ–‡æ¡£è¦æ±‚

æ–‡æ¡£è¦æ±‚æ ¹æ®å¤æ‚åº¦çº§åˆ«è¿›è¡Œè°ƒæ•´ï¼š

| æ–‡æ¡£ç±»å‹ | çº§åˆ« 1 | çº§åˆ« 2 | çº§åˆ« 3 | çº§åˆ« 4 |
|---------------|---------|---------|---------|---------|
| é—®é¢˜å®šä¹‰ | ç®€è¦ | æ ‡å‡† | è¯¦ç»† | å…¨é¢ |
| é€‰é¡¹åˆ†æ | å¯é€‰ | åŸºæœ¬ | å¤šé€‰é¡¹ | å¹¿æ³› |
| å®æ–½è®¡åˆ’ | ç®€å• | æ ‡å‡† | è¯¦ç»† | åˆ†é˜¶æ®µ |
| æµ‹è¯•è¦æ±‚ | åŸºæœ¬ | æ ‡å‡† | å…¨é¢ | ä¸¥æ ¼ |
| æ–‡æ¡£ç¼–å†™ | æœ€å°‘ | æ ‡å‡† | è¯¦ç»† | å¹¿æ³› |

## ğŸ“‘ æŒ‰çº§åˆ«ä¼˜åŒ–çš„æ¨¡æ¿

### çº§åˆ« 1ï¼šå¿«é€Ÿä¿®å¤æ¨¡æ¿
```markdown
## QUICK FIX: [Issue Name]
- Problem: [Brief description]
- Solution: [Implemented approach]
- Verification: [How fix was tested]
```

### çº§åˆ« 2ï¼šå¢å¼ºåŠŸèƒ½æ¨¡æ¿
```markdown
## ENHANCEMENT: [Feature Name]
- Requirement: [What needs to be done]
- Approach: [How it was implemented]
- Testing: [Verification approach]
- Documentation: [Where documented]
```

### çº§åˆ« 3-4ï¼šç»¼åˆæ¨¡æ¿
ä½¿ç”¨ä¼˜åŒ–çš„åˆ›æ„é˜¶æ®µæ¨¡æ¿ï¼Œæ ¹æ®éœ€è¦è°ƒæ•´æ–‡æ¡£æ·±åº¦

## ğŸ”„ å‚è€ƒå›¾è¡¨

æ¯ä¸ªæ¨¡å¼çš„å¯è§†åŒ–æµç¨‹å›¾éƒ½ç»è¿‡ Token æ•ˆç‡ä¼˜åŒ–ï¼š

- @VAN æ¨¡å¼å›¾ï¼ˆå·²ä¼˜åŒ–ï¼‰
- @PLAN æ¨¡å¼å›¾ï¼ˆå·²ä¼˜åŒ–ï¼‰
- @CREATIVE æ¨¡å¼å›¾ï¼ˆå·²ä¼˜åŒ–ï¼‰
- @BUILD æ¨¡å¼å›¾ï¼ˆå·²ä¼˜åŒ–ï¼‰
- @REFLECT æ¨¡å¼å›¾ï¼ˆå·²ä¼˜åŒ–ï¼‰
- @ARCHIVE æ¨¡å¼å›¾ï¼ˆå·²ä¼˜åŒ–ï¼‰

## âš¡ Token æ•ˆç‡æ”¹è¿›

æœ¬ç‰ˆæœ¬çš„ä¼˜åŒ–æªæ–½ï¼š

1. åˆ†å±‚è§„åˆ™åŠ è½½ï¼ˆå‡å°‘ 65% Tokenï¼‰
2. æ¸è¿›å¼åˆ›æ„é˜¶æ®µæ–‡æ¡£ï¼ˆå‡å°‘ 60% Tokenï¼‰
3. æ¨¡å¼è½¬æ¢æœŸé—´çš„ä¸Šä¸‹æ–‡ä¿ç•™ï¼ˆå‡å°‘ 40% Tokenï¼‰
4. å·®å¼‚åŒ–memory bankæ›´æ–°ï¼ˆå‡å°‘ 30% Tokenï¼‰
5. åŸºäºå¤æ‚åº¦çš„æ¨¡æ¿ç¼©æ”¾ï¼ˆå› çº§åˆ«è€Œå¼‚ï¼‰

## ğŸ’¡ ä½¿ç”¨æŒ‡å—

ä½¿ç”¨ä¼˜åŒ–ç³»ç»Ÿçš„æ–¹æ³•ï¼š

1. ä» VAN å‘½ä»¤å¼€å§‹åˆå§‹åŒ–å¹¶ç¡®å®šå¤æ‚åº¦
2. éµå¾ªä¸å¤æ‚åº¦ç›¸åŒ¹é…çš„å·¥ä½œæµç¨‹
3. ä½¿ç”¨ä¸ä»»åŠ¡å¤æ‚åº¦ç›¸é€‚åº”çš„æ¸è¿›å¼æ–‡æ¡£
4. è®©ç³»ç»Ÿç®¡ç†è§„åˆ™åŠ è½½å’Œä¸Šä¸‹æ–‡ä¿ç•™
5. åœ¨ä¿æŒç»“æ„åŒ–å¼€å‘çš„åŒæ—¶äº«å—æ”¹è¿›çš„ Token æ•ˆç‡
