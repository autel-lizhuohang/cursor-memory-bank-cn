---
description: è®°å¿†åº“ä¼˜åŒ–çš„é›†æˆä¸­å¿ƒ
globs: "**/optimization*/**", "**/integration*/**"
alwaysApply: false
---

# è®°å¿†åº“ä¼˜åŒ–é›†æˆ

> **æ‘˜è¦:** æœ¬æ–‡ä»¶ä½œä¸ºæ‰€æœ‰è®°å¿†åº“ä¼˜åŒ–çš„é›†æˆç‚¹ï¼Œåè°ƒå„ç§ä¼˜åŒ–ç»„ä»¶æ— ç¼åä½œã€‚

## ä¼˜åŒ–é›†æˆæµç¨‹

```mermaid
graph TD
    Start["è®°å¿†åº“<br>åˆå§‹åŒ–"] --> HRL["åˆ†å±‚<br>è§„åˆ™åŠ è½½"]
    HRL --> ACM["è‡ªé€‚åº”<br>å¤æ‚åº¦æ¨¡å‹"]
    ACM --> DCM["åŠ¨æ€<br>ä¸Šä¸‹æ–‡ç®¡ç†"]
    DCM --> TMO["è½¬æ¢<br>ä¼˜åŒ–"]

    subgraph "çº§åˆ«ç‰¹å®šä¼˜åŒ–"
        L1["çº§åˆ« 1<br>ä¼˜åŒ–"]
        L2["çº§åˆ« 2<br>ä¼˜åŒ–"]
        L3["çº§åˆ« 3<br>ä¼˜åŒ–"]
        L4["çº§åˆ« 4<br>ä¼˜åŒ–"]
    end

    ACM --> L1 & L2 & L3 & L4

    L1 & L2 & L3 & L4 --> CPO["åˆ›æ„é˜¶æ®µ<br>ä¼˜åŒ–"]

    CPO --> PDO["æ¸è¿›å¼<br>æ–‡æ¡£"]
    TMO --> PDO

    PDO --> MBO["è®°å¿†åº“<br>ä¼˜åŒ–"]

    style Start fill:#4da6ff,stroke:#0066cc,color:white
    style HRL fill:#ffa64d,stroke:#cc7a30,color:white
    style ACM fill:#4dbb5f,stroke:#36873f,color:white
    style DCM fill:#d94dbb,stroke:#a3378a,color:white
    style TMO fill:#4dbbbb,stroke:#368787,color:white
    style CPO fill:#e699d9,stroke:#d94dbb,color:white
    style PDO fill:#d971ff,stroke:#a33bc2,color:white
    style MBO fill:#ff71c2,stroke:#c23b8a,color:white
```

## ä¼˜åŒ–ç»„ä»¶æ³¨å†Œè¡¨

```javascript
// ä¼˜åŒ–ç»„ä»¶æ³¨å†Œè¡¨ä¼ªä»£ç 
const optimizationRegistry = {
  // æ ¸å¿ƒä¼˜åŒ–
  hierarchicalRuleLoading: {
    file: "Core/hierarchical-rule-loading.mdc",
    dependencies: [],
    priority: 1
  },
  adaptiveComplexityModel: {
    file: "main.mdc",
    dependencies: ["hierarchicalRuleLoading"],
    priority: 2
  },
  modeTransitionOptimization: {
    file: "Core/mode-transition-optimization.mdc",
    dependencies: ["hierarchicalRuleLoading", "adaptiveComplexityModel"],
    priority: 3
  },

  // çº§åˆ«ç‰¹å®šä¼˜åŒ–
  level1Optimization: {
    file: "Level1/optimized-workflow-level1.mdc",
    dependencies: ["adaptiveComplexityModel"],
    priority: 4
  },

  // åŠŸèƒ½ç‰¹å®šä¼˜åŒ–
  creativePhaseOptimization: {
    file: "Phases/CreativePhase/optimized-creative-template.mdc",
    dependencies: ["hierarchicalRuleLoading", "adaptiveComplexityModel"],
    priority: 5
  }
};
```

## ä¼˜åŒ–åˆå§‹åŒ–åºåˆ—

```mermaid
sequenceDiagram
    participant MB as è®°å¿†åº“
    participant Reg as ä¼˜åŒ–æ³¨å†Œè¡¨
    participant HRL as åˆ†å±‚è§„åˆ™åŠ è½½
    participant ACM as è‡ªé€‚åº”å¤æ‚åº¦
    participant TMO as è½¬æ¢ä¼˜åŒ–
    participant CPO as åˆ›æ„é˜¶æ®µä¼˜åŒ–

    MB->>Reg: è¯·æ±‚ä¼˜åŒ–åˆå§‹åŒ–
    Reg->>Reg: æŒ‰ä¼˜å…ˆçº§å’Œä¾èµ–é¡¹æ’åºä¼˜åŒ–
    Reg->>HRL: åˆå§‹åŒ– (ä¼˜å…ˆçº§ 1)
    HRL-->>Reg: åˆå§‹åŒ–å®Œæˆ
    Reg->>ACM: åˆå§‹åŒ– (ä¼˜å…ˆçº§ 2)
    ACM->>HRL: è¯·æ±‚è§„åˆ™åŠ è½½æœåŠ¡
    HRL-->>ACM: æä¾›è§„åˆ™åŠ è½½
    ACM-->>Reg: åˆå§‹åŒ–å®Œæˆ
    Reg->>TMO: åˆå§‹åŒ– (ä¼˜å…ˆçº§ 3)
    TMO->>HRL: è¯·æ±‚è§„åˆ™åŠ è½½æœåŠ¡
    TMO->>ACM: è¯·æ±‚å¤æ‚åº¦æ¨¡å‹
    HRL-->>TMO: æä¾›è§„åˆ™åŠ è½½
    ACM-->>TMO: æä¾›å¤æ‚åº¦æ¨¡å‹
    TMO-->>Reg: åˆå§‹åŒ–å®Œæˆ
    Reg->>CPO: åˆå§‹åŒ– (æœ€ç»ˆ)
    CPO->>HRL: è¯·æ±‚è§„åˆ™åŠ è½½æœåŠ¡
    CPO->>ACM: è¯·æ±‚å¤æ‚åº¦æ¨¡å‹
    CPO->>TMO: è¯·æ±‚è½¬æ¢æœåŠ¡
    HRL-->>CPO: æä¾›è§„åˆ™åŠ è½½
    ACM-->>CPO: æä¾›å¤æ‚åº¦æ¨¡å‹
    TMO-->>CPO: æä¾›è½¬æ¢æœåŠ¡
    CPO-->>Reg: åˆå§‹åŒ–å®Œæˆ
    Reg-->>MB: æ‰€æœ‰ä¼˜åŒ–å·²åˆå§‹åŒ–
```

## ä¼˜åŒ–é…ç½®

```javascript
// ä¼˜åŒ–é…ç½®ä¼ªä»£ç 
const optimizationConfig = {
  // ä»¤ç‰Œä¼˜åŒ–è®¾ç½®
  tokenOptimization: {
    enableHierarchicalLoading: true,
    enableProgressiveDocumentation: true,
    enableLazyRuleLoading: true,
    enableContextPruning: true
  },

  // ä¸Šä¸‹æ–‡ä¿ç•™è®¾ç½®
  contextPreservation: {
    preserveDesignDecisions: true,
    preserveImplementationContext: true,
    preserveUserPreferences: true,
    contextCompressionLevel: "high" // none, low, medium, high
  },

  // æ–‡æ¡£ä¼˜åŒ–
  documentationOptimization: {
    level1DocumentationLevel: "minimal", // minimal, standard, comprehensive
    level2DocumentationLevel: "standard",
    level3DocumentationLevel: "comprehensive",
    level4DocumentationLevel: "comprehensive",
    enableProgressiveDisclosure: true,
    enableTemplateCaching: true
  }
};
```

## ä¼˜åŒ–ç›‘æ§

```mermaid
graph TD
    Monitor["ä¼˜åŒ–<br>ç›‘æ§å™¨"] --> TokenUsage["ä»¤ç‰Œä½¿ç”¨<br>è·Ÿè¸ª"]
    Monitor --> ContextEfficiency["ä¸Šä¸‹æ–‡<br>æ•ˆç‡"]
    Monitor --> RuleLoadingStats["è§„åˆ™åŠ è½½<br>ç»Ÿè®¡"]
    Monitor --> DocumentationSize["æ–‡æ¡£<br>å¤§å°"]

    TokenUsage --> Dashboard["ä¼˜åŒ–<br>ä»ªè¡¨æ¿"]
    ContextEfficiency --> Dashboard
    RuleLoadingStats --> Dashboard
    DocumentationSize --> Dashboard

    Dashboard --> Feedback["ä¼˜åŒ–<br>åé¦ˆå¾ªç¯"]
    Feedback --> Config["ä¼˜åŒ–<br>é…ç½®"]
    Config --> Monitor

    style Monitor fill:#4da6ff,stroke:#0066cc,color:white
    style Dashboard fill:#ffa64d,stroke:#cc7a30,color:white
    style Feedback fill:#4dbb5f,stroke:#36873f,color:white
    style Config fill:#d94dbb,stroke:#a3378a,color:white
```

## ä¼˜åŒ–æŒ‡æ ‡

```markdown
# ä¼˜åŒ–æŒ‡æ ‡

## ä»¤ç‰Œä½¿ç”¨
- æ ¸å¿ƒè§„åˆ™åŠ è½½: [X] ä»¤ç‰Œ
- æ¨¡å¼ç‰¹å®šè§„åˆ™: [Y] ä»¤ç‰Œ
- åˆ›æ„é˜¶æ®µæ–‡æ¡£: [Z] ä»¤ç‰Œ
- æ€»ä½“ä»¤ç‰Œå‡å°‘: [P]%

## ä¸Šä¸‹æ–‡æ•ˆç‡
- ä¸Šä¸‹æ–‡åˆ©ç”¨ç‡: [Q]%
- ä¸Šä¸‹æ–‡æµªè´¹: [R]%
- æœ‰æ•ˆä»¤ç‰Œå®¹é‡: [S] ä»¤ç‰Œ

## è§„åˆ™åŠ è½½
- å·²åŠ è½½è§„åˆ™: [T] / [U] (æ€»è®¡)
- å»¶è¿ŸåŠ è½½è§„åˆ™: [V]
- ç¼“å­˜è§„åˆ™: [W]

## æ–‡æ¡£
- çº§åˆ« 1 æ–‡æ¡£å¤§å°: [X] ä»¤ç‰Œ
- çº§åˆ« 2 æ–‡æ¡£å¤§å°: [Y] ä»¤ç‰Œ
- çº§åˆ« 3 æ–‡æ¡£å¤§å°: [Z] ä»¤ç‰Œ
- çº§åˆ« 4 æ–‡æ¡£å¤§å°: [AA] ä»¤ç‰Œ
```

## é›†æˆä½¿ç”¨ç¤ºä¾‹

### åˆå§‹åŒ–æ‰€æœ‰ä¼˜åŒ–

```javascript
// åˆå§‹åŒ–æ‰€æœ‰ä¼˜åŒ–çš„ä¼ªä»£ç 
function initializeMemoryBankOptimizations() {
  // åŠ è½½ä¼˜åŒ–æ³¨å†Œè¡¨
  const registry = loadOptimizationRegistry();

  // æŒ‰ä¼˜å…ˆçº§å’Œä¾èµ–é¡¹æ’åº
  const sortedOptimizations = sortOptimizations(registry);

  // æŒ‰é¡ºåºåˆå§‹åŒ–æ¯ä¸ªä¼˜åŒ–
  for (const opt of sortedOptimizations) {
    initializeOptimization(opt);
  }

  // é…ç½®ä¼˜åŒ–å‚æ•°
  configureOptimizations(loadOptimizationConfig());

  // å¼€å§‹ç›‘æ§
  initializeOptimizationMonitoring();

  return "è®°å¿†åº“ä¼˜åŒ–å·²åˆå§‹åŒ–";
}
```

### ä½¿ç”¨ä¼˜åŒ–çš„åˆ›æ„é˜¶æ®µ

```markdown
// ä½¿ç”¨å¸¦æ¸è¿›å¼æ–‡æ¡£çš„ä¼˜åŒ–åˆ›æ„é˜¶æ®µ

// ä»¥æœ€å°æ–‡æ¡£åˆå§‹åŒ–
ğŸ“Œ åˆ›æ„é˜¶æ®µå¼€å§‹: è®¤è¯ç³»ç»Ÿ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1ï¸âƒ£ é—®é¢˜
   æè¿°: ä¸ºåº”ç”¨ç¨‹åºè®¾è®¡è®¤è¯ç³»ç»Ÿ
   éœ€æ±‚: å®‰å…¨ã€å¯æ‰©å±•ã€æ”¯æŒ SSOã€æ˜“äºç»´æŠ¤
   çº¦æŸ: å¿…é¡»ä¸ç°æœ‰ç”¨æˆ·æ•°æ®åº“é…åˆä½¿ç”¨ï¼Œå“åº”æ—¶é—´ <100ms

2ï¸âƒ£ é€‰é¡¹
   é€‰é¡¹ A: åŸºäº JWT çš„æ— çŠ¶æ€è®¤è¯
   é€‰é¡¹ B: ä½¿ç”¨ Redis çš„ä¼šè¯è®¤è¯
   é€‰é¡¹ C: OAuth2 å®ç°

// æ ¹æ®éœ€è¦æ¸è¿›æ·»åŠ ç»†èŠ‚
3ï¸âƒ£ åˆ†æ
   | æ ‡å‡† | JWT | Sessions | OAuth2 |
   |-----------|-----|----------|--------|
   | å®‰å…¨æ€§ | â­â­â­ | â­â­â­â­ | â­â­â­â­â­ |
   | å¯æ‰©å±•æ€§ | â­â­â­â­â­ | â­â­â­ | â­â­â­â­ |
   | å¤æ‚åº¦ | â­â­ | â­â­â­ | â­â­â­â­ |

// ä¸“æ³¨äºå†³ç­–å’Œå®æ–½
4ï¸âƒ£ å†³ç­–
   é€‰æ‹©: é€‰é¡¹ A: å¸¦åˆ·æ–°ä»¤ç‰Œçš„ JWT è®¤è¯
   ç†ç”±: æ€§èƒ½å’Œå¯æ‰©å±•æ€§çš„æœ€ä½³å¹³è¡¡

5ï¸âƒ£ å®æ–½ç¬”è®°
   - ä½¿ç”¨ HS256 ç®—æ³•è¿›è¡Œä»¤ç‰Œç­¾å
   - å®ç°çŸ­æœŸè®¿é—®ä»¤ç‰Œ (15åˆ†é’Ÿ)
   - åœ¨ Redis ä¸­å­˜å‚¨ä»¤ç‰Œé»‘åå•ä»¥è¿›è¡Œæ’¤é”€
```

## æ¨¡å¼è½¬æ¢ç¤ºä¾‹

```markdown
// ä» CREATIVE åˆ° BUILD çš„ä¼˜åŒ–æ¨¡å¼è½¬æ¢

# æ¨¡å¼è½¬æ¢: CREATIVE â†’ BUILD

## ä¸Šä¸‹æ–‡æ‘˜è¦
- ä»»åŠ¡: è®¤è¯ç³»ç»Ÿå®æ–½
- å¤æ‚åº¦: çº§åˆ« 3
- å†³ç­–: å¸¦åˆ·æ–°ä»¤ç‰Œçš„ JWT è®¤è¯

## å…³é”®ä¸Šä¸‹æ–‡
- å®‰å…¨éœ€æ±‚å·²éªŒè¯
- ç®—æ³•é€‰æ‹©: HS256
- ä»¤ç‰Œç”Ÿå‘½å‘¨æœŸ: 15åˆ†é’Ÿè®¿é—® / 7å¤©åˆ·æ–°

## åç»­æ­¥éª¤
1. å®ç° JWT ç”Ÿæˆæ¨¡å—
2. åˆ›å»ºä»¤ç‰ŒéªŒè¯ä¸­é—´ä»¶
3. æ„å»ºåˆ·æ–°ä»¤ç‰Œå¤„ç†

// è½¬æ¢æ—¶ä¿ç•™ä¸Šä¸‹æ–‡
// BUILD æ¨¡å¼ç»§ç»­ä½¿ç”¨æ­¤ä¸Šä¸‹æ–‡
```

## åˆ†å±‚è§„åˆ™åŠ è½½ç¤ºä¾‹

```javascript
// åˆ†å±‚è§„åˆ™åŠ è½½çš„ä¼ªä»£ç ç¤ºä¾‹

// åˆå§‹åŠ è½½ - ä»…æ ¸å¿ƒè§„åˆ™
loadCoreRules();

// ç¡®å®šå¤æ‚åº¦
const complexity = determineComplexity();

// åŠ è½½æ¨¡å¼ç‰¹å®šçš„å¿…è¦è§„åˆ™
loadModeEssentialRules("CREATIVE");

// ä¸ºä¸“ä¸šè§„åˆ™æ³¨å†Œå»¶è¿ŸåŠ è½½å™¨
registerLazyLoader("architecture", () => loadRule("creative-phase-architecture.mdc"));
registerLazyLoader("algorithm", () => loadRule("creative-phase-algorithm.mdc"));
registerLazyLoader("uiux", () => loadRule("creative-phase-uiux.mdc"));

// ç¨åï¼Œå½“éœ€è¦æ¶æ„è®¾è®¡æ—¶:
const architectureRule = loadSpecializedRule("architecture");
// æ¶æ„è§„åˆ™ç°åœ¨ä»…åœ¨éœ€è¦æ—¶åŠ è½½
```

è¿™äº›é›†æˆçš„ä¼˜åŒ–æ— ç¼åä½œï¼Œæä¾›æ˜¾è‘—æ›´é«˜æ•ˆçš„è®°å¿†åº“ç³»ç»Ÿï¼ŒåŒæ—¶ä¿æŒæ‰€æœ‰åŠŸèƒ½ã€‚
