---
description: VAN 模式复杂度判定的可视化流程图
globs: van-complexity-determination.mdc
alwaysApply: false
---
# VAN 模式：复杂度判定

> **简述：** 此组件用于判定当前任务的适当复杂度级别（1-4），并相应地引导工作流程。

## 🔍 复杂度决策树

```mermaid
graph TD
    Start["新任务"] --> Q1{"是否为 Bug 修复<br>或错误更正？"}
    Q1 -->|是| Q1a{"只影响单个<br>组件？"}
    Q1a -->|是| L1["级别 1：<br>快速 Bug 修复"]
    Q1a -->|否| Q1b{"影响多个<br>组件？"}
    Q1b -->|是| L2["级别 2：<br>简单增强"]
    Q1b -->|否| Q1c{"影响系统<br>架构？"}
    Q1c -->|是| L3["级别 3：<br>中等功能"]
    Q1c -->|否| L2

    Q1 -->|否| Q2{"添加小型<br>功能或<br>增强？"}
    Q2 -->|是| Q2a{"独立的<br>变更？"}
    Q2a -->|是| L2
    Q2a -->|否| Q2b{"影响多个<br>组件？"}
    Q2b -->|是| L3
    Q2b -->|否| L2

    Q2 -->|否| Q3{"需要多个<br>组件的完整<br>功能？"}
    Q3 -->|是| Q3a{"有架构<br>影响？"}
    Q3a -->|是| L4["级别 4：<br>复杂系统"]
    Q3a -->|否| L3

    Q3 -->|否| Q4{"系统级或<br>架构级<br>变更？"}
    Q4 -->|是| L4
    Q4 -->|否| L3

    style Start fill:#4da6ff,stroke:#0066cc,color:white
    style L1 fill:#10b981,stroke:#059669,color:white
    style L2 fill:#f6546a,stroke:#c30052,color:white
    style L3 fill:#f6546a,stroke:#c30052,color:white
    style L4 fill:#f6546a,stroke:#c30052,color:white
```

## 📋 级别指标

### 级别 1：快速 Bug 修复
- **关键词**：fix、bug、error、crash、issue
- **范围**：单个组件
- **时间**：数分钟到数小时
- **风险**：低，隔离的
- **示例**：按钮不工作、样式问题

### 级别 2：简单增强
- **关键词**：add、improve、update、enhance
- **范围**：单个组件/子系统
- **时间**：数小时到 1-2 天
- **风险**：中等，可控的
- **示例**：添加表单字段、改进验证

### 级别 3：中等功能
- **关键词**：implement、create、develop
- **范围**：多个组件
- **时间**：数天到 1-2 周
- **风险**：显著
- **示例**：用户认证、仪表板

### 级别 4：复杂系统
- **关键词**：system、architecture、redesign
- **范围**：多个子系统
- **时间**：数周到数月
- **风险**：高，架构级
- **示例**：支付系统、微服务

## 📋 复杂度检查清单

```
✓ 复杂度判定
- 任务类型已识别？[是/否]
- 范围已评估？[是/否]
- 时间已估算？[是/否]
- 风险已评估？[是/否]
- 依赖关系已映射？[是/否]

→ 如果全部为是：继续执行级别特定的工作流程
→ 如果有否：完成评估
```

## 🔄 级别转换触发条件

```mermaid
graph TD
    Current["当前级别"] --> Higher["升级触发条件"]
    Current --> Lower["降级触发条件"]

    Higher --> H1["多个组件"]
    Higher --> H2["设计决策"]
    Higher --> H3["系统影响"]

    Lower --> L1["隔离变更"]
    Lower --> L2["简单修复"]
    Lower --> L3["无需设计"]

    style Current fill:#4da6ff,stroke:#0066cc,color:white
    style Higher fill:#f6546a,stroke:#c30052,color:white
    style Lower fill:#10b981,stroke:#059669,color:white
```

## 📋 工作流程加载

根据判定的级别：
- 级别 1：继续在 VAN 模式
- 级别 2-4：转换到 PLAN 模式

**下一步：** 加载适当的级别特定工作流程

## 🚨 模式转换触发（VAN 到 PLAN）

如果复杂度被判定为级别 2、3 或 4：

```
🚫 检测到级别 [2-4] 任务
在 VAN 模式中的实现已被阻止
此任务需要 PLAN 模式
您必须切换到 PLAN 模式以进行适当的文档记录和规划
输入 'PLAN' 以切换到规划模式
```

## 📋 检查点验证模板（示例）

```
✓ 章节检查点：复杂度判定
- 任务已分析？[是/否]
- 复杂度级别已确定？[是/否]

→ 如果级别 1：继续完成 VAN 模式。
→ 如果级别 2-4：触发 PLAN 模式转换。
```

**下一步（级别 1）：** 完成 VAN 初始化（例如，如需要则初始化记忆库）。
**下一步（级别 2-4）：** 退出 VAN 模式并启动 PLAN 模式。
