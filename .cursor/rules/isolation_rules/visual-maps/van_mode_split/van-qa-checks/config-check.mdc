---
description: VAN QA é…ç½®éªŒè¯çš„æµç¨‹å›¾
globs: van-qa-checks/config-check.mdc
alwaysApply: false
---
# VAN QAï¼šé…ç½®éªŒè¯

> **ç®€è¿°ï¼š** æ­¤ç»„ä»¶éªŒè¯é…ç½®æ–‡ä»¶çš„è¯­æ³•æ­£ç¡®æ€§ä»¥åŠä¸é¡¹ç›®å’Œå¹³å°çš„å…¼å®¹æ€§ã€‚

## 2ï¸âƒ£ é…ç½®éªŒè¯æµç¨‹

```mermaid
graph TD
    Start["é…ç½®éªŒè¯"] --> IdentifyConfigs["è¯†åˆ«é…ç½®<br>æ–‡ä»¶"]
    IdentifyConfigs --> ReadConfigs["è¯»å–é…ç½®<br>æ–‡ä»¶"]
    ReadConfigs --> ValidateSyntax["éªŒè¯è¯­æ³•<br>å’Œæ ¼å¼"]
    ValidateSyntax --> SyntaxStatus{"è¯­æ³•<br>æœ‰æ•ˆï¼Ÿ"}

    SyntaxStatus -->|"æ˜¯"| CheckCompatibility["æ£€æŸ¥ä¸å¹³å°çš„<br>å…¼å®¹æ€§"]
    SyntaxStatus -->|"å¦"| FixSyntax["ä¿®å¤è¯­æ³•<br>é”™è¯¯"]
    FixSyntax --> RetryValidate["é‡è¯•éªŒè¯"]
    RetryValidate --> SyntaxStatus

    CheckCompatibility --> CompatStatus{"ä¸å¹³å°<br>å…¼å®¹ï¼Ÿ"}
    CompatStatus -->|"æ˜¯"| ConfigSuccess["é…ç½®å·²éªŒè¯<br>âœ… é€šè¿‡"]
    CompatStatus -->|"å¦"| AdaptConfigs["è°ƒæ•´é…ç½®<br>ä»¥é€‚åº”å¹³å°"]
    AdaptConfigs --> RetryCompat["é‡è¯•å…¼å®¹æ€§<br>æ£€æŸ¥"]
    RetryCompat --> CompatStatus

    style Start fill:#4da6ff,stroke:#0066cc,color:white
    style ConfigSuccess fill:#10b981,stroke:#059669,color:white
    style SyntaxStatus fill:#f6546a,stroke:#c30052,color:white
    style CompatStatus fill:#f6546a,stroke:#c30052,color:white
```

### é…ç½®éªŒè¯å®ç°ï¼š
```powershell
# ç¤ºä¾‹ï¼šä¸º Web é¡¹ç›®éªŒè¯é…ç½®æ–‡ä»¶
function Validate-Configurations {
    $configFiles = @(
        "package.json",
        "tsconfig.json",
        "vite.config.js"
    )

    $invalidConfigs = @()
    $incompatibleConfigs = @()

    foreach ($configFile in $configFiles) {
        if (Test-Path $configFile) {
            # æ£€æŸ¥ JSON æ–‡ä»¶çš„ JSON è¯­æ³•
            if ($configFile -match "\.json$") {
                try {
                    Get-Content $configFile -Raw | ConvertFrom-Json | Out-Null
                } catch {
                    $invalidConfigs += "$configFile (JSON è¯­æ³•é”™è¯¯ï¼š$($_.Exception.Message))"
                    continue
                }
            }

            # ç‰¹å®šé…ç½®å…¼å®¹æ€§æ£€æŸ¥
            if ($configFile -eq "vite.config.js") {
                $content = Get-Content $configFile -Raw
                # æ£€æŸ¥ Vite é…ç½®ä¸­çš„ React æ’ä»¶
                if ($content -notmatch "react\(\)") {
                    $incompatibleConfigs += "$configFile (React é¡¹ç›®ç¼ºå°‘ React æ’ä»¶)"
                }
            }
        } else {
            $invalidConfigs += "$configFile (æ–‡ä»¶æœªæ‰¾åˆ°)"
        }
    }

    # æ˜¾ç¤ºç»“æœ
    if ($invalidConfigs.Count -eq 0 -and $incompatibleConfigs.Count -eq 0) {
        Write-Output "âœ… æ‰€æœ‰é…ç½®å·²éªŒè¯ä¸”å…¼å®¹"
        return $true
    } else {
        if ($invalidConfigs.Count -gt 0) {
            Write-Output "âŒ æ— æ•ˆé…ç½®ï¼š$($invalidConfigs -join ', ')"
        }
        if ($incompatibleConfigs.Count -gt 0) {
            Write-Output "âŒ ä¸å…¼å®¹é…ç½®ï¼š$($incompatibleConfigs -join ', ')"
        }
        return $false
    }
}
```

## ğŸ“‹ é…ç½®éªŒè¯æ£€æŸ¥ç‚¹

```
âœ“ æ£€æŸ¥ç‚¹ï¼šé…ç½®éªŒè¯
- æ‰€æœ‰é…ç½®æ–‡ä»¶å·²æ‰¾åˆ°ï¼Ÿ[æ˜¯/å¦]
- æ‰€æœ‰é…ç½®è¯­æ³•æœ‰æ•ˆï¼Ÿ[æ˜¯/å¦]
- æ‰€æœ‰é…ç½®ä¸å¹³å°å…¼å®¹ï¼Ÿ[æ˜¯/å¦]

â†’ å¦‚æœå…¨éƒ¨ä¸ºæ˜¯ï¼šç»§ç»­ç¯å¢ƒéªŒè¯ã€‚
â†’ å¦‚æœæœ‰å¦ï¼šç»§ç»­å‰è¯·ä¿®å¤é…ç½®é—®é¢˜ã€‚
```

**ä¸‹ä¸€æ­¥ï¼ˆé€šè¿‡æ—¶ï¼‰ï¼š** åŠ è½½ `van-qa-checks/environment-check.mdc`ã€‚
**ä¸‹ä¸€æ­¥ï¼ˆå¤±è´¥æ—¶ï¼‰ï¼š** æŸ¥çœ‹ `van-qa-utils/common-fixes.mdc` è·å–é…ç½®ä¿®å¤æ–¹æ³•ã€‚
